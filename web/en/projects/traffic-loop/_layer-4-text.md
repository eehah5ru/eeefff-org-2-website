**Инструкия по стенду 1**

loop\_routing

**Требования к оборудованию:**

1. Свободное место более 130Г
2. Памяти 4Гб и более
4. Желательно не менее 2 ядер.

**Краткое описание:**

Стенд состоит из трех виртуальных машин с ОС Centos7.5  
На каждом маршрутизаторе находятся два сетевых интерфеса с включенным форвардингом   
Зацикливание трафика происходит на IP 192.168.50.10  
На каждом маршрутизаторе устанавливается TTL на IP 192.168.50.10 в 64  
На каждом интерфейсе отключен reverse path filter (rp\_filter)  
Примерная производительность на моей машине  5800 пакетов/секунда


**Пошаговое выполнение:**

1. Скачиваем и устанавливаем vagrant( если нет) https://www.vagrantup.com/downloads.html
2. Скачиваем и устанавливаем putty https://www.chiark.greenend.org.uk/sgtatham/putty/latest.html
3. Разархивируем файлы проекта в любую папку
4. Запускаем cmd или powershell заходим в эту папку и далее в папку loop
5. Запускаем стенд. 
	vagrant up
6. Смотрим порты которые приписал к каждой машине vagrant
	vagrant ssh-config
7. Запускаем программу pageant (из состава putty)
8. Нажимаем в систем трее не иконку этой программы выбираем "add key"
9. Выбираем из разархивированной папки файл id_rsa.ppk
10. Открываем putty набираем адрес 127.0.0.1 в поле "порт" ставим Port из пункта 6 для сервера server1
	в имени пользователя, когда запросит указываем vagrant
11. То же для server2
12. То же для server3
13. Взаимно пингуем IP на разных серверах прилегающие интерфесы других серверов (этот этап нужен, для того чтобы проверить подключение сети, а так же сеть при загрузке в virtualBox иногда залипает, и не просыпается пока не пройдет трафик в обе стороны) то есть если IP, например, 192.168.202.1 не пингуется с server1, то на server1 ставим ping 192.168.202.1
	а на server3 ping 192.168.202.2	ждем некоторое время (до 10 секунд) и сеть просыпается
14. Когда все пинги есть на server2 или server3 ставим слежение пакетов IP 192.168.50.10  
	sudo tcpdump -ni eth1 host 192.168.50.10
15. на каком-то из серверов запускаем 1 пакет ping на IP 192.168.50.10  
	ping -c 1 192.168.50.10
16. Смотрим на tcpdump и видим зацикленный пакет
	каждая новая строчка это одно прохождение через интерфейс eth1
17. Чтобы остановить нужно выполнить команду на server1
	sudo vagrant/routing.sh stop
18. Чтобы заново включить маршрутизацию 
	sudo vagrant/routing.sh start
